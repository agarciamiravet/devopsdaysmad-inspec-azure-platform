title "Identity and Access Management"

# you add controls here
control "azure-identity-access-management-1.23" do 
  impact 1.0                                                                  
  title "Ensure that no custom subscription owner roles are created "
  tag "cis-1.23"
  describe azurerm_role_definitions do
    its ('properties.first.permissions.first')  { should have_attributes(notActions: [
        'Microsoft.Authorization/*/Delete',
        'Microsoft.Authorization/*/Write',
        'Microsoft.Authorization/elevateAccess/Action',
        'Microsoft.Blueprint/blueprintAssignments/write',
        'Microsoft.Blueprint/blueprintAssignments/delete'
    ]) }
  end

end
